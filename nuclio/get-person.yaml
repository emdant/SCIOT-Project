metadata:
  name: get-person
  labels:
    nuclio.io/project-name: simple-tracing
spec:
  handler: "main:handler"
  runtime: nodejs
  resources: {}
  triggers:
    get-person-http:
      kind: http
      name: get-person-http
      maxWorkers: 1
      annotations: {}
      attributes:
        port: 32001
        cors:
          enabled: true
  build:
    functionSourceCode: Y29uc3QgeyBNb25nb0NsaWVudCB9ID0gcmVxdWlyZSgibW9uZ29kYiIpOw0KY29uc3QgdXJpID0gJ21vbmdvZGI6Ly9yb290OmV4YW1wbGVAMTcyLjE3LjAuMToyNzAxNy8nDQpsZXQgcmVwZWF0cyA9IDE7DQoNCmV4cG9ydHMuaGFuZGxlciA9IGZ1bmN0aW9uKGNvbnRleHQsIGV2ZW50KSB7DQogICAgbGV0IGRhdGFTdHJpbmcgPSBldmVudC5ib2R5LnRvU3RyaW5nKCk7DQoNCiAgICBjb250ZXh0LmxvZ2dlci5pbmZvKGRhdGFTdHJpbmcpOw0KDQogICAgaWYgKGRhdGFTdHJpbmcpIHsNCiAgICAgICAgbGV0IHBlcnNvbkRhdGEgPSBKU09OLnBhcnNlKGRhdGFTdHJpbmcpOw0KDQogICAgICAgIGNvbnN0IGNsaWVudCA9IGNvbnRleHQuZGJDbGllbnQ7DQogICAgICAgIGlmIChjbGllbnQpIHsNCiAgICAgICAgICAgIGNvbnN0IGRhdGFiYXNlID0gY2xpZW50LmRiKCd0cmFjaW5nJyk7DQogICAgICAgICAgICBjb25zdCBwZW9wbGUgPSBkYXRhYmFzZS5jb2xsZWN0aW9uKCdwZW9wbGUnKTsNCg0KICAgICAgICAgICAgY29uc3QgaW5wdXREYXRlID0gbmV3IERhdGUocGVyc29uRGF0YS5kYXRldGltZSk7DQoNCiAgICAgICAgICAgIGNvbnN0IGN1cnNvciA9IHBlb3BsZS5maW5kKHsNCiAgICAgICAgICAgICAgICBmaXNjYWxjb2RlOiBwZXJzb25EYXRhLmZpc2NhbGNvZGUudG9VcHBlckNhc2UoKSwNCiAgICAgICAgICAgICAgICBkYXRldGltZTogew0KICAgICAgICAgICAgICAgICAgICAkZ3RlOiBuZXcgRGF0ZShpbnB1dERhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCwpKSwNCiAgICAgICAgICAgICAgICAgICAgJGx0OiBuZXcgRGF0ZShpbnB1dERhdGUuc2V0SG91cnMoMjMsIDU5LCA1OSkpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwge3Byb2plY3Rpb246IHtfaWQ6IDB9fSk7DQoNCiAgICAgICAgICAgIGN1cnNvci50b0FycmF5KChlcnJvciwgYXJyYXkpID0+IHsNCiAgICAgICAgICAgICAgICBjb250ZXh0LmNhbGxiYWNrKG5ldyBjb250ZXh0LlJlc3BvbnNlKHtyZXN1bHRzOiBhcnJheX0sIG51bGwsICdhcHBsaWNhdGlvbi9qc29uJywgMjAwLCAndGV4dCcpKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb250ZXh0LmxvZ2dlci5pbmZvKCdDYW5ub3QgcmVhZCBmcm9tIGRiOiB1bmFibGUgdG8gY29ubmVjdCcpOw0KICAgICAgICAgICAgY29udGV4dC5jYWxsYmFjayhuZXcgY29udGV4dC5SZXNwb25zZShgU2VydmVyIGVycm9yYCwgbnVsbCwgJ3RleHQvcGxhaW4nLCA1MDAsICd0ZXh0JykpOw0KICAgICAgICB9DQoNCiAgICB9IGVsc2Ugew0KICAgICAgICBjb250ZXh0LmNhbGxiYWNrKG5ldyBjb250ZXh0LlJlc3BvbnNlKCdNYWxmb3JtZWQgcmVxdWVzdDogZXhwZWN0ZWQgUE9TVCcsIG51bGwsICd0ZXh0L3BsYWluJywgNDAwLCAndGV4dCcpKTsNCiAgICB9DQoNCn07DQoNCmV4cG9ydHMuaW5pdENvbnRleHQgPSB0cnlDb25uZWN0aW9uOw0KDQpmdW5jdGlvbiB0cnlDb25uZWN0aW9uKGNvbnRleHQpIHsNCiAgICBjb25zdCBjbGllbnQgPSBuZXcgTW9uZ29DbGllbnQodXJpKTsNCiAgICBjbGllbnQuY29ubmVjdCgoZXJyLCBjbGllbnQpID0+IHsNCiAgICAgICAgaWYgKGVycikgew0KICAgICAgICAgICAgc2V0VGltZW91dCgoY29udGV4dCkgPT4gdHJ5Q29ubmVjdGlvbihjb250ZXh0KSwgMjAwMCAqIHJlcGVhdHMpOw0KICAgICAgICAgICAgcmVwZWF0cyAqPSAyOw0KICAgICAgICB9DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGNvbnRleHQuZGJDbGllbnQgPSBjbGllbnQ7DQogICAgfSk7DQp9
    baseImage: "node:lts-alpine"
    commands:
      - 'npm install mongodb'
    runtimeAttributes:
      repositories: []
    codeEntryType: sourceCode
    timestamp: 1632386004
  loggerSinks:
    - level: debug
  platform: {}
  securityContext: {}
  eventTimeout: ""
