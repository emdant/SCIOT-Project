metadata:
  name: scan-person
  labels:
    nuclio.io/project-name: sciot-project
spec:
  handler: "main:handler"
  runtime: nodejs
  resources: {}
  triggers:
    ScannerTrigger:
      class: ""
      kind: rabbit-mq
      name: ScannerTrigger
      url: "amqp://guest:guest@192.168.0.1:5672"
      attributes:
        exchangeName: iot/scanners
        topics:
          - person
    default-http:
      class: ""
      kind: http
      name: default-http
      maxWorkers: 1
  build:
    functionSourceCode: Y29uc3QgeyBNb25nb0NsaWVudCB9ID0gcmVxdWlyZSgibW9uZ29kYiIpOw0KY29uc3QgdXJpID0gJ21vbmdvZGI6Ly9yb290OmV4YW1wbGVAMTkyLjE2OC4wLjE6MjcwMTcvJw0KDQpleHBvcnRzLmhhbmRsZXIgPSBmdW5jdGlvbihjb250ZXh0LCBldmVudCkgew0KICAgIGxldCBkYXRhU3RyaW5nID0gZXZlbnQuYm9keS50b1N0cmluZygpOw0KICAgIGxldCBwZXJzb25EYXRhID0gSlNPTi5wYXJzZShkYXRhU3RyaW5nKTsNCg0KICAgIGNvbnN0IGNsaWVudCA9IGNvbnRleHQuZGJDbGllbnQ7DQogICAgaWYgKGNsaWVudCkgew0KICAgICAgICBjb25zdCBkYXRhYmFzZSA9IGNsaWVudC5kYigndHJhY2luZycpOw0KICAgICAgICBjb25zdCBwZW9wbGUgPSBkYXRhYmFzZS5jb2xsZWN0aW9uKCdwZW9wbGUnKTsNCg0KICAgICAgICBwZW9wbGUuaW5zZXJ0T25lKHBlcnNvbkRhdGEsIHt9LCAocmVzdWx0KSA9PiB7DQogICAgICAgICAgICBjb250ZXh0LmxvZ2dlci5pbmZvKGBBZGRlZCBlbnRyeSBmb3IgJHtwZXJzb25EYXRhLmZpc2NhbGNvZGV9YCk7DQogICAgICAgICAgICBjb250ZXh0LmNhbGxiYWNrKCdBZGRlZCBkYXRhICcgKyBkYXRhU3RyaW5nKTsNCiAgICAgICAgfSk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbygnQ2Fubm90IHdyaXRlIHRvIGRiOiB1bmFibGUgdG8gY29ubmVjdCcpOw0KICAgIH0NCn07DQoNCmV4cG9ydHMuaW5pdENvbnRleHQgPSBmdW5jdGlvbihjb250ZXh0KSB7DQogICAgY29uc3QgY2xpZW50ID0gbmV3IE1vbmdvQ2xpZW50KHVyaSk7DQogICAgY2xpZW50LmNvbm5lY3QoKGVyciwgY2xpZW50KSA9PiB7DQogICAgICAgIGlmIChlcnIpIA0KICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgY29udGV4dC5kYkNsaWVudCA9IGNsaWVudDsNCiAgICB9KTsgICANCn07
    baseImage: "node:lts-alpine"
    commands:
      - 'npm install amqplib'
      - 'npm install mongodb'
    runtimeAttributes:
      repositories: []
    codeEntryType: sourceCode
    timestamp: 1632314908
  loggerSinks:
    - level: debug
  platform: {}
  securityContext: {}
  eventTimeout: ""
