metadata:
  name: get-person
  labels:
    nuclio.io/project-name: sciot-project
spec:
  handler: "main:handler"
  runtime: nodejs
  resources: {}
  triggers:
    get-person-http:
      kind: http
      name: get-person-http
      maxWorkers: 1
      annotations: {}
      attributes:
        port: 32001
        cors:
          enabled: true
  build:
    functionSourceCode: Y29uc3QgeyBNb25nb0NsaWVudCB9ID0gcmVxdWlyZSgibW9uZ29kYiIpOw0KY29uc3QgdXJpID0gJ21vbmdvZGI6Ly9yb290OmV4YW1wbGVAMTkyLjE2OC4wLjE6MjcwMTcvJw0KDQpleHBvcnRzLmhhbmRsZXIgPSBmdW5jdGlvbihjb250ZXh0LCBldmVudCkgew0KICAgIGxldCBkYXRhU3RyaW5nID0gZXZlbnQuYm9keS50b1N0cmluZygpOw0KDQogICAgY29udGV4dC5sb2dnZXIuaW5mbyhkYXRhU3RyaW5nKTsNCg0KICAgIGlmIChkYXRhU3RyaW5nKSB7DQogICAgICAgIGxldCBwZXJzb25EYXRhID0gSlNPTi5wYXJzZShkYXRhU3RyaW5nKTsNCg0KICAgICAgICBjb25zdCBjbGllbnQgPSBjb250ZXh0LmRiQ2xpZW50Ow0KICAgICAgICBpZiAoY2xpZW50KSB7DQogICAgICAgICAgICBjb25zdCBkYXRhYmFzZSA9IGNsaWVudC5kYigndHJhY2luZycpOw0KICAgICAgICAgICAgY29uc3QgcGVvcGxlID0gZGF0YWJhc2UuY29sbGVjdGlvbigncGVvcGxlJyk7DQoNCiAgICAgICAgICAgIGNvbnN0IGlucHV0RGF0ZSA9IG5ldyBEYXRlKHBlcnNvbkRhdGEuZGF0ZXRpbWUpOw0KDQogICAgICAgICAgICBjb25zdCBjdXJzb3IgPSBwZW9wbGUuZmluZCh7DQogICAgICAgICAgICAgICAgZmlzY2FsY29kZTogcGVyc29uRGF0YS5maXNjYWxjb2RlLnRvVXBwZXJDYXNlKCksDQogICAgICAgICAgICAgICAgZGF0ZXRpbWU6IHsNCiAgICAgICAgICAgICAgICAgICAgJGd0ZTogbmV3IERhdGUoaW5wdXREYXRlLnNldEhvdXJzKDAsIDAsIDAsIDAsKSksDQogICAgICAgICAgICAgICAgICAgICRsdDogbmV3IERhdGUoaW5wdXREYXRlLnNldEhvdXJzKDIzLCA1OSwgNTkpKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIHtwcm9qZWN0aW9uOiB7X2lkOiAwfX0pOw0KDQogICAgICAgICAgICBjdXJzb3IudG9BcnJheSgoZXJyb3IsIGFycmF5KSA9PiB7DQogICAgICAgICAgICAgICAgY29udGV4dC5jYWxsYmFjayhuZXcgY29udGV4dC5SZXNwb25zZSh7cmVzdWx0czogYXJyYXl9LCBudWxsLCAnYXBwbGljYXRpb24vanNvbicsIDIwMCwgJ3RleHQnKSk7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgY29udGV4dC5sb2dnZXIuaW5mbygnQ2Fubm90IHJlYWQgZnJvbSBkYjogdW5hYmxlIHRvIGNvbm5lY3QnKTsNCiAgICAgICAgICAgIGNvbnRleHQuY2FsbGJhY2sobmV3IGNvbnRleHQuUmVzcG9uc2UoYFNlcnZlciBlcnJvcmAsIG51bGwsICd0ZXh0L3BsYWluJywgNTAwLCAndGV4dCcpKTsNCiAgICAgICAgfQ0KDQogICAgfSBlbHNlIHsNCiAgICAgICAgY29udGV4dC5jYWxsYmFjayhuZXcgY29udGV4dC5SZXNwb25zZSgnTWFsZm9ybWVkIHJlcXVlc3Q6IGV4cGVjdGVkIFBPU1QnLCBudWxsLCAndGV4dC9wbGFpbicsIDQwMCwgJ3RleHQnKSk7DQogICAgfQ0KDQp9Ow0KDQpleHBvcnRzLmluaXRDb250ZXh0ID0gZnVuY3Rpb24oY29udGV4dCkgew0KICAgIGNvbnN0IGNsaWVudCA9IG5ldyBNb25nb0NsaWVudCh1cmkpOw0KICAgIGNsaWVudC5jb25uZWN0KChlcnIsIGNsaWVudCkgPT4gew0KICAgICAgICBpZiAoZXJyKSANCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGNvbnRleHQuZGJDbGllbnQgPSBjbGllbnQ7DQogICAgfSk7ICAgDQp9Ow==
    baseImage: "node:lts-alpine"
    commands:
      - 'npm install amqplib'
      - 'npm install mongodb'
    runtimeAttributes:
      repositories: []
    codeEntryType: sourceCode
    timestamp: 1632386004
  loggerSinks:
    - level: debug
  platform: {}
  securityContext: {}
  eventTimeout: ""
